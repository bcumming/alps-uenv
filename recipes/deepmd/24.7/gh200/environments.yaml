tensorflow:
  compiler:
  - toolchain: gcc
    spec: gcc@12.3
  mpi:
    spec: cray-mpich@8.1.30
    gpu: cuda
  unify: true
  specs:
  #- aws-ofi-nccl@master
  #- cmake
  #- cuda
  #- nccl
  #- ninja
  #- protobuf@3.25.3
  #- python
  #- py-numpy
  #- py-tensorflow +nccl
  - py-tensorflow +nccl
  #- py-mpi4py
  - py-ase
  - py-scipy
  - py-numpy
  - py-pyyaml
  - py-args
  - py-pyproject-metadata
  - py-python-hostlist
  - py-sphinx-argparse
  - py-pygments
  - py-sphinxcontrib-bibtex
  - py-scikit-build-core
  - py-setuptools-scm
  - py-scikit-build
  - py-hatch-fancy-pypi-readme
  - py-pip
  - py-h5py
  - llvm ~cuda
  - deepmd@2.2.11 +tensorflow
  #- lammps@20240207.1 +user-deepmd +cuda cuda_arch=90 +python +kokkos
  - kokkos@4.3.00 +wrapper +cuda cuda_arch=90
  - lammps +user-deepmd +cuda cuda_arch=90 +python +kokkos
  variants:
  - +mpi
  - +cuda
  - cuda_arch=90
  views:
    deepmd:
      link: run
      uenv:
        add_compilers: true
        prefix_paths:
          LD_LIBRARY_PATH: [lib, lib64]
    tf:
      link: roots
      exclude: ['deepmd']
      uenv:
        add_compilers: true
        prefix_paths:
          LD_LIBRARY_PATH: [lib, lib64]
